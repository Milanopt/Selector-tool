<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Speaker Selector</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    body{font-family:system-ui, sans-serif;padding:1rem;line-height:1.4;background:#f9fafb;color:#111}
    h1{font-size:1.75rem;margin-bottom:1rem}
    .filters{display:flex;flex-wrap:wrap;gap:1rem;margin-bottom:1rem}
    .filter-group{display:flex;flex-direction:column}
    table{width:100%;border-collapse:collapse}
    th,td{padding:0.5rem;border-bottom:1px solid #ddd;text-align:left;font-size:0.875rem}
    th{background:#f3f4f6}
    tr:hover{background:#fef3c7}
    .badge{padding:0.1rem 0.4rem;border-radius:0.25rem;font-size:0.75rem;display:inline-block}
    .badge-yes{background:#10b981;color:white}
    .badge-no{background:#ef4444;color:white}
  </style>
</head>
<body>
  <h1>Speaker Selector</h1>

  <section class="filters">
    <div class="filter-group">
      <label><strong>Mount type</strong></label>
      <label><input type="checkbox" name="mount_type" value="surface mount" checked> Surface</label>
      <label><input type="checkbox" name="mount_type" value="ceiling mount" checked> Ceiling</label>
      <label><input type="checkbox" name="mount_type" value="pendant" checked> Pendant</label>
    </div>

    <div class="filter-group">
      <label><strong>RMS power (W)</strong></label>
      <input type="number" id="powerMin" placeholder="Min" style="width:70px">
      <input type="number" id="powerMax" placeholder="Max" style="width:70px">
    </div>

    <div class="filter-group">
      <label><strong>Impedance (Ω)</strong></label>
      <select id="impedanceFilter">
        <option value="">Any</option>
        <option>4</option><option>6</option><option>8</option><option>16</option>
      </select>
    </div>

    <div class="filter-group">
      <label><strong>Weatherproof</strong></label>
      <label><input type="checkbox" id="weatherproofOnly"> Yes only</label>
    </div>

    <div class="filter-group">
      <label><strong>100V taps</strong></label>
      <label><input type="checkbox" id="has100vOnly"> Yes only</label>
    </div>

    <div class="filter-group">
      <label><strong>Search</strong></label>
      <input type="text" id="searchBox" placeholder="Brand or model">
    </div>

    <button id="resetBtn" style="height:2.3rem;align-self:flex-end">Reset</button>
  </section>

  <table id="results">
    <thead>
      <tr>
        <th>Brand</th><th>Model</th><th>Mount</th><th>RMS W</th><th>Ω</th>
        <th>Sens dB</th><th>Max SPL</th><th>Disp (H/V)</th><th>Driver</th>
        <th>Dims (mm)</th><th>Weather</th><th>100V</th><th>Max Tap W</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <script>
    // Replace this array with a fetch to your JSON endpoint in production
    const products = [
      {
        "id":"audac-ateo6m-8ohm",
        "brand":"AUDAC",
        "model":"ATEO6M",
        "mount_type":"surface mount",
        "rms_power_w":60,
        "impedance_ohm":8,
        "sensitivity_db_1w1m":89,
        "max_spl_db":106,
        "dispersion_deg":{"horizontal":120,"vertical":120},
        "driver_configuration":"1× 6\" woofer",
        "dimensions_mm":{"width":193.1,"height":347.5,"depth":215.2},
        "weatherproof":true,
        "has_100v_taps":true,
        "max_tap_w_100v":50
      },
      {
        "id":"audac-ateo6dm-16ohm",
        "brand":"AUDAC",
        "model":"ATEO6DM",
        "mount_type":"surface mount",
        "rms_power_w":60,
        "impedance_ohm":16,
        "sensitivity_db_1w1m":89,
        "max_spl_db":106,
        "dispersion_deg":{"horizontal":120,"vertical":120},
        "driver_configuration":"1× 6\" woofer",
        "dimensions_mm":{"width":193.1,"height":347.5,"depth":215.2},
        "weatherproof":true,
        "has_100v_taps":true,
        "max_tap_w_100v":50
      }
    ];

    function renderTable(data){
      const tbody = document.querySelector('#results tbody');
      tbody.innerHTML = '';
      data.forEach(p=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${p.brand}</td>
          <td>${p.model}</td>
          <td>${p.mount_type}</td>
          <td>${p.rms_power_w}</td>
          <td>${p.impedance_ohm}</td>
          <td>${p.sensitivity_db_1w1m}</td>
          <td>${p.max_spl_db}</td>
          <td>${p.dispersion_deg.horizontal} / ${p.dispersion_deg.vertical}</td>
          <td>${p.driver_configuration}</td>
          <td>${p.dimensions_mm.width}&times;${p.dimensions_mm.height}&times;${p.dimensions_mm.depth}</td>
          <td><span class="badge badge-${p.weatherproof?'yes':'no'}">${p.weatherproof?'Yes':'No'}</span></td>
          <td><span class="badge badge-${p.has_100v_taps?'yes':'no'}">${p.has_100v_taps?'Yes':'No'}</span></td>
          <td>${p.max_tap_w_100v ?? ''}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function passesFilters(p){
      const mountTypes = [...document.querySelectorAll('input[name="mount_type"]:checked')].map(i=>i.value);
      if(!mountTypes.includes(p.mount_type)) return false;

      const powerMin = parseFloat(document.getElementById('powerMin').value) || -Infinity;
      const powerMax = parseFloat(document.getElementById('powerMax').value) || Infinity;
      if(p.rms_power_w < powerMin || p.rms_power_w > powerMax) return false;

      const imp = document.getElementById('impedanceFilter').value;
      if(imp && p.impedance_ohm != parseInt(imp)) return false;

      if(document.getElementById('weatherproofOnly').checked && !p.weatherproof) return false;
      if(document.getElementById('has100vOnly').checked && !p.has_100v_taps) return false;

      const search = document.getElementById('searchBox').value.trim().toLowerCase();
      if(search && !(p.brand.toLowerCase().includes(search) || p.model.toLowerCase().includes(search))) return false;

      return true;
    }

    function applyFilters(){
      const filtered = products.filter(passesFilters);
      renderTable(filtered);
    }

    document.querySelectorAll('.filters input, .filters select').forEach(el=>el.addEventListener('input', applyFilters));
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      document.querySelectorAll('.filters input').forEach(i=>{
        if(i.type==='checkbox') {
          i.checked = true;
          if(i.id==='weatherproofOnly' || i.id==='has100vOnly') i.checked = false;
        }
        if(i.type==='number' || i.type==='text') i.value = '';
      });
      document.getElementById('impedanceFilter').value = '';
      applyFilters();
    });

    applyFilters();

    /* PRODUCTION NOTE:
       Replace the inline 'products' array with a dynamic fetch, e.g.:

       fetch('/data/speakers.json')
         .then(r=>r.json())
         .then(json=>{
           products.splice(0, products.length, ...json); // mutate array
           applyFilters();
         });
    */
  </script>
</body>
</html>
